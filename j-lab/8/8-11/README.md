## 2D 누적합이란

예를 들어,
A[i][j]는 **(0,0)**에서부터 **(i,j)**까지의 모든 원소 합을 저장하고 있는 배열이다.

원본 배열을 arr라고 하면,

```python
A[i][j] = arr[0][0] + arr[0][1] + ... + arr[i][j]
```

이런식으로 생성된다.

## 구간에 따른 2D 누적합 구하기

2D 누적합에서 구하고자 하는것은 어떤 부분 사각형 (i1, j1) ~ (i2, j2) 의 합이다.

이걸 누적합 배열 A를 이용해서 표현할 수 있다.

(1) **전체 영역**
우선 (0,0)~(i2,j2) 까지의 합은 이미 A[i2][j2]에 들어있음.

```python
sum = A[i2][j2]
```

그런데 이는 원하는 영역보다 위쪽과 왼쪽이 더 포함되어 있다.
따라서 그걸 빼줘야 함.

(2) **위쪽 빼기**
(i1, j1)(i2, j2)를 구하고 싶은데,
그 위쪽 **(0,0)(i1-1, j2)** 부분이 포함되어 있으니 빼야 한다.

```python
sum -= A[i1-1][j2]
```

(3) **왼쪽 빼기**

또, 왼쪽 **(0,0)~(i2, j1-1)** 부분도 포함되어 있으니 그것도 빼야 한다.

```python
sum -= A[i2][j1-1]
```

(4) **두 번 뺀 부분 더하기**
문제는 (0,0)~(i1-1, j1-1) 영역이
위쪽을 뺄 때 한 번, 왼쪽을 뺄 때 또 한 번 빠졌다는 것이다.
그래서 이 부분을 다시 더해준다.

```python
sum += A[i1-1][j1-1]
```

## 최종 공식

```python
sum = A[i2][j2]
if i1 > 0: sum -= A[i1-1][j2]
if j1 > 0: sum -= A[i2][j1-1]
if i1 > 0 and j1 > 0: sum += A[i1-1][j1-1]
```
